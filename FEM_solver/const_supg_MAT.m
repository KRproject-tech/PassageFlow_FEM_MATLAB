%% SUPG項定数マトリクス作成
global R_tensor T_tensor;

for i=1:ELEM_NUM_max 

    %% SUPG移流項
    R_tensor(:,:,1,1) = 2*S(i)/40320*[ 720 48  48  120 24  120;
                                       48  48  8   36  12  12 ;
                                       48  8   48  12  12  36 ;
                                       120 36  12  48  12  24 ;
                                       24  12  12  12  8   12 ;
                                       120 12  36  24  12  48 ];                                   
    R_tensor(:,:,1,2) = 2*S(i)/40320*[ 120 36  12  48  12  24 ;
                                       36  120 12  48  24  12 ;
                                       12  12  24  8   12  12 ;
                                       48  48  8   36  12  12 ;
                                       12  24  12  12  12  8  ;
                                       24  12  12  12  8   12 ];                                   
    R_tensor(:,:,1,3) = 2*S(i)/40320*[ 120 12  36  24  12  48 ;
                                       12  24  12  12  12  8  ;
                                       36  12  120 12  24  48 ;
                                       24  12  12  12  8   12 ;
                                       12  12  24  8   12  12 ;
                                       48  8   48  12  12  36 ];
                                   
    R_tensor(:,:,2,1) = R_tensor(:,:,1,2);    
    R_tensor(:,:,2,2) = 2*S(i)/40320*[ 48  48  8   36  12  12 ;
                                       48  720 48  120 120 24 ;
                                       8   48  48  12  36  12 ;
                                       36  120 12  48  24  12 ;
                                       12  120 36  24  48  12 ;
                                       12  24  12  12  12  8  ];                                   
    R_tensor(:,:,2,3) = 2*S(i)/40320*[ 24  12  12  12  8   12 ;
                                       12  120 36  24  48  12 ;
                                       12  36  120 12  48  24 ;
                                       12  24  12  12  12  8  ;
                                       8   48  48  12  36  12 ;
                                       12  12  24  8   12  12 ];
                                   
    R_tensor(:,:,3,1) = R_tensor(:,:,1,3);       
    R_tensor(:,:,3,2) = R_tensor(:,:,2,3);                                    
    R_tensor(:,:,3,3) = 2*S(i)/40320*[ 48  8   48  12  12  36 ;
                                       8   48  48  12  36  12 ;
                                       48  48  720 24  120 120;
                                       12  12  24  8   12  12 ;
                                       12  36  120 12  48  24 ;
                                       36  12  120 12  24  48 ];
                                   
                                   
    %% SUPG拡散項・圧力項                               
    T_tensor = 2*S(i)/120*[ 6 2 2;
                            2 6 2;
                            2 2 6;
                            2 2 1;
                            1 2 2;
                            2 1 2];     
    
end
